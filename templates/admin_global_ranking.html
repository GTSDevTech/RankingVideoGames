{% extends 'base.html' %}
{% load static %}

{% block nav %}
  {% include 'includes/nav.html' %}

{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/users.css' %}">
  <link rel="stylesheet" href="{% static 'css/admin_tabs.css' %}">
  <link rel="stylesheet" href="{% static 'css/admin_global_stats.css' %}">
 
{% endblock %}

{% block body_class %}bg-user{% endblock %}

{% block body %}
<main class="user-content">
    {% include 'includes/admin_tabs.html' %}
  <div class="container-fluid px-5 user-panel-wrap">
    <section class="user-panel">

      <div class="user-toolbar">
        <div class="user-toolbar__left">
          <span class="user-dot"></span>
          <h2 class="user-title">Global Ranking</h2>
        </div>

        <div class="user-toolbar__right">
         <form method="get">
            <select class="stats-select"  name="limit" onchange="this.form.submit()">
              {% for n in limit_options %}
                <option value="{{ n }}" {% if n == limit %}selected{% endif %}>
                  Top {{ n }}
                </option>
              {% endfor %}
            </select>
          </form>
        </div>
      </div>

      <div class="gstats-list">
        {% for r in rows %}
          <article class="gstats-row">

            <div class="gstats-rank" aria-hidden="true">
              <span class="gstats-rank__num">{{ forloop.counter }}</span>
            </div>

            <div class="gstats-cover">
              {% if r.cover %}
                <img src="{{ r.cover }}" alt="{{ r.name }}">
              {% else %}
                <div class="gstats-cover__ph">
                  <i class="fa-solid fa-gamepad"></i>
                </div>
              {% endif %}
            </div>

            <div class="gstats-main">
              <div class="gstats-title">
                <span class="gstats-title__name">{{ r.name }}</span>
              </div>

              <div class="gstats-posbar" aria-label="Distribución de posiciones">
                <span class="gpos gpos--p1"><i class="fa-solid fa-medal"></i> #1 <b>{{ r.pos_counts.1|default:0 }}</b></span>
                <span class="gpos gpos--p2"><i class="fa-solid fa-medal"></i> #2 <b>{{ r.pos_counts.2|default:0 }}</b></span>
                <span class="gpos gpos--p3"><i class="fa-solid fa-medal"></i> #3 <b>{{ r.pos_counts.3|default:0 }}</b></span>
                <span class="gpos gpos--p4"><i class="fa-solid fa-hashtag"></i> #4 <b>{{ r.pos_counts.4|default:0 }}</b></span>
                <span class="gpos gpos--p5"><i class="fa-solid fa-hashtag"></i> #5 <b>{{ r.pos_counts.5|default:0 }}</b></span>
              </div>
            </div>

       

              <div class="gstats-sub">
                <span class="gstats-chip gstats-chip--pts">
                  <i class="fa-solid fa-trophy"></i> {{ r.points }} pts
                </span>
                <span class="gstats-chip">
                  <i class="fa-solid fa-users"></i> {{ r.appearances }} rankings
                </span>
                <span class="gstats-chip">
                  <i class="fa-solid fa-star"></i>Pos.Avg: {{ r.pos_avg }}
                </span>
              </div>

          </article>
        {% empty %}
          <div class="stats-empty">No hay rankings aún.</div>
        {% endfor %}
      </div>
    </section>
  </div>
</main>
{% endblock %}